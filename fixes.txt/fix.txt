fixes

another fix added.

another bug detected and fixed

another fifth bug detected and fixed

another sixth bug detected and fixed.